<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Targenia - Beställningar</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
body { font-family: Arial; background:#1f1f2e; color:#fff; margin:0; padding:20px; }
h1 { text-align:center; }
.order { background:#2c2c44; padding:15px; margin:10px 0; border-radius:12px; }
button { margin:5px 5px 0 0; padding:6px 10px; border:none; border-radius:6px; cursor:pointer; }
.completed { background:#1dd1a1; color:#000; }
.refunded { background:#ff6b6b; color:#fff; }
</style>
</head>
<body>

<h1>Beställningar</h1>
<div id="ordersContainer"></div>

<script>
const SUPABASE_URL = 'https://ahfrpztyepvdiyakgkwt.supabase.co';
const SUPABASE_KEY = 'DIN_SUPABASE_ANVÄNDARKEY_HÄR';
const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

async function loadOrders(){
  const { data: orders, error } = await supabase.from('orders').select('*');
  if(error){ alert("Fel: "+error.message); return; }
  const container = document.getElementById('ordersContainer');
  container.innerHTML = "";

  orders.forEach(order=>{
    const div = document.createElement('div');
    div.className = 'order';
    div.innerHTML = `
      <strong>Ordernummer:</strong> ${order.order_number}<br>
      <strong>Förnamn:</strong> ${order.first_name}<br>
      <strong>Efternamn:</strong> ${order.last_name}<br>
      <strong>Minecraft:</strong> ${order.minecraft_name}<br>
      <strong>Adress:</strong> ${order.address}<br>
      <strong>Hemleverans:</strong> ${order.home_delivery}<br>
      <strong>Expressleverans:</strong> ${order.express_delivery}<br>
      <strong>Anteckningar:</strong> ${order.notes || ""}<br>
      <strong>Produkter:</strong> ${JSON.stringify(order.items)}<br>
      <button onclick="markCompleted('${order.id}', this)" class="completed">Avklarad</button>
      <button onclick="markRefunded('${order.id}', this)" class="refunded">Återbetald</button>
    `;
    container.appendChild(div);
  });
}

async function markCompleted(id, btn){
  const { error } = await supabase.from('orders').update({completed:true}).eq('id', id);
  if(error){ alert("Fel: "+error.message); return; }
  btn.disabled = true;
}

async function markRefunded(id, btn){
  const { error } = await supabase.from('orders').update({refunded:true}).eq('id', id);
  if(error){ alert("Fel: "+error.message); return; }
  btn.disabled = true;
}

loadOrders();
</script>

</body>
</html>
